# –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –Ω–∞ ESP32-CAM

## –í—Å—Ç—É–ø

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ (ALPR - Automatic License Plate Recognition) –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ –º—ñ–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ ESP32-CAM. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—Ñ–ª–∞–π–Ω, –±–µ–∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Ö–º–∞—Ä–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤.

**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–∏ (3 –µ—Ç–∞–ø–∏):**
1. **–í–∏—è–≤–ª–µ–Ω–Ω—è** - –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ
2. **–ö–æ—Ä–µ–∫—Ü—ñ—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏** - –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—É—Ç—ñ–≤ –Ω–æ–º–µ—Ä—É –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è
3. **–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤** - —á–∏—Ç–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –∑ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É (OCR)

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ESP32-CAM (AI-Thinker)
- –§—Ä–µ–π–º–≤–æ—Ä–∫: Arduino + TensorFlow Lite
- –°–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ä–æ–∑—Ä–æ–±–∫–∏: PlatformIO (VS Code)
- –ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è: TensorFlow/Keras + Python

---

## –ß–∞—Å—Ç–∏–Ω–∞ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –∑–±—ñ—Ä–∫–∞

### 1.1 –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Visual Studio Code
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑ https://code.visualstudio.com/
2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞ —Å–≤—ñ–π –∫–æ–º–ø'—é—Ç–µ—Ä
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å VS Code

#### –ö—Ä–æ–∫ 2: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è PlatformIO IDE
1. –£ VS Code –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —ñ–∫–æ–Ω–∫—É "Extensions" (Ctrl+Shift+X)
2. –ó–Ω–∞–π–¥—ñ—Ç—å "PlatformIO IDE"
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Install"
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å VS Code –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

#### –ö—Ä–æ–∫ 3: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Python (–¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π)
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ Python 3.8+ –∑ https://www.python.org/downloads/
2. **–í–ê–ñ–õ–ò–í–û:** –ü—ñ–¥ —á–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Å—Ç–∞–≤—Ç–µ –≥–∞–ª–æ—á–∫—É "Add Python to PATH"
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è: –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ —ñ –≤–≤–µ–¥—ñ—Ç—å:
   ```bash
   python --version
   ```

#### –ö—Ä–æ–∫ 4: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –¥—Ä–∞–π–≤–µ—Ä–∏ –¥–ª—è ESP32-CAM
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ CP210x USB to UART Driver:
   - https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers
2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –¥—Ä–∞–π–≤–µ—Ä
3. **–ü—Ä–∏–º—ñ—Ç–∫–∞:** –î–ª—è –ø—Ä–æ—à–∏–≤–∫–∏ ESP32-CAM –ø–æ—Ç—Ä—ñ–±–µ–Ω USB-TTL –∞–¥–∞–ø—Ç–µ—Ä (FTDI –∞–±–æ CP2102)

### 1.2 –í—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ç–∞ –∑–±—ñ—Ä–∫–∞ –ø—Ä–æ—î–∫—Ç—É

#### –ö—Ä–æ–∫ 1: –í—ñ–¥–∫—Ä–∏–π—Ç–µ –ø—Ä–æ—î–∫—Ç
1. –£ VS Code: File ‚Üí Open Folder
2. –í–∏–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É `Esp32Cam_LPR`
3. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó PlatformIO (–≤–Ω–∏–∑—É –Ω–∞ –ø–∞–Ω–µ–ª—ñ –∑'—è–≤–ª—è—Ç—å—Å—è –∫–Ω–æ–ø–∫–∏)

#### –ö—Ä–æ–∫ 2: –ó–±–µ—Ä—ñ—Ç—å –ø—Ä–æ—î–∫—Ç
1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —ñ–∫–æ–Ω–∫—É PlatformIO (–≥–æ–ª–æ–≤–∞ –º—É—Ä–∞—Ö–∏) –Ω–∞ –ª—ñ–≤—ñ–π –ø–∞–Ω–µ–ª—ñ
2. –£ —Ä–æ–∑–¥—ñ–ª—ñ "Project Tasks" ‚Üí "esp32cam" ‚Üí "General" –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "Build"
3. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–±—ñ—Ä–∫–∏ (–∑–∞–π–º–∞—î 2-5 —Ö–≤–∏–ª–∏–Ω)
4. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –Ω–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫ (warnings –º–æ–∂–Ω–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ (—á–µ—Ä–µ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª):**
```bash
cd D:\Sandbox\ESP ML\Esp32Cam_LPR
pio run
```

### 1.3 –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è ESP32-CAM —Ç–∞ –ø—Ä–æ—à–∏–≤–∫–∞

#### –°—Ö–µ–º–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è ESP32-CAM –¥–æ USB-TTL –∞–¥–∞–ø—Ç–µ—Ä–∞

| ESP32-CAM | USB-TTL |
|-----------|---------|
| GND       | GND     |
| 5V        | 5V      |
| U0R (RX)  | TX      |
| U0T (TX)  | RX      |
| IO0       | GND (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –ø—Ä–æ—à–∏–≤–∫–∏!) |

**–í–ê–ñ–õ–ò–í–û:** GPIO0 (IO0) –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ GND —Ç—ñ–ª—å–∫–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ—à–∏–≤–∫–∏!

#### –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –ø—Ä–æ—à–∏–≤–∫–∏
1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å ESP32-CAM –¥–æ USB-TTL –∞–¥–∞–ø—Ç–µ—Ä–∞ –∑–≥—ñ–¥–Ω–æ —Å—Ö–µ–º–∏
2. **–û–±–æ–≤'—è–∑–∫–æ–≤–æ** –∑'—î–¥–Ω–∞–π—Ç–µ IO0 –∑ GND (–ø–µ—Ä–µ–º–∏—á–∫–æ—é)
3. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å USB-TTL –¥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
4. –í–∏–∑–Ω–∞—á—Ç–µ COM-–ø–æ—Ä—Ç —É Device Manager (–î–∏—Å–ø–µ—Ç—á–µ—Ä –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤)

#### –ö—Ä–æ–∫ 2: –ü—Ä–æ—à–∏–≤–∫–∞
1. –£ VS Code –≤—ñ–¥–∫—Ä–∏–π—Ç–µ `platformio.ini`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –≤–∫–∞–∑–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π COM-–ø–æ—Ä—Ç:
   ```ini
   upload_port = COM3  ; –ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à –ø–æ—Ä—Ç
   monitor_port = COM3
   ```
3. –£ PlatformIO: Project Tasks ‚Üí esp32cam ‚Üí General ‚Üí **Upload**
4. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è "SUCCESS"

#### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
1. **–í–Ü–î–ö–õ–Æ–ß–Ü–¢–¨** –ø–µ—Ä–µ–º–∏—á–∫—É –º—ñ–∂ IO0 —Ç–∞ GND
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É RESET –Ω–∞ ESP32-CAM
3. –ü–ª–∞—Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∑ –Ω–æ–≤–æ—é –ø—Ä–æ—à–∏–≤–∫–æ—é

### 1.4 –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

#### –í—ñ–¥–∫—Ä–∏–π—Ç–µ Serial Monitor
1. –£ PlatformIO: Project Tasks ‚Üí esp32cam ‚Üí General ‚Üí **Monitor**
2. –ê–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –∑ —ñ–∫–æ–Ω–∫–æ—é "—à—Ç–µ–∫–µ—Ä–∞" –≤–Ω–∏–∑—É –µ–∫—Ä–∞–Ω—É
3. –®–≤–∏–¥–∫—ñ—Å—Ç—å: 115200 baud (–≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ)

#### –©–æ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏:
```
============================================================
ESP32-CAM License Plate Recognition
3-Stage ALPR Pipeline
============================================================
Camera initialized successfully!
Free heap: 234567 bytes

[Stage 1] Detection model initialized
[Stage 2] Polygon model initialized  
[Stage 3] OCR model initialized

System ready!
============================================================
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –ü–æ–∫–∏ —â–æ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞–≥–ª—É—à–∫–∏ –º–æ–¥–µ–ª–µ–π —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —Ñ—ñ–∫—Ç–∏–≤–Ω—ñ –¥–∞–Ω—ñ. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–≤—á–∏—Ç–∏ —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—ñ.

---

## –ß–∞—Å—Ç–∏–Ω–∞ 2: –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è

### 2.1 –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Python
–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ç–µ—Ä–º—ñ–Ω–∞–ª (PowerShell –∞–±–æ CMD) —Ç–∞ –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

```bash
pip install tensorflow==2.13.0
pip install numpy opencv-python pillow
pip install matplotlib pandas
pip install scikit-learn
pip install labelImg  # –î–ª—è —Ä–æ–∑–º—ñ—Ç–∫–∏ –¥–∞–Ω–∏—Ö
```

#### –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä—ñ—Ç—å —Ä–æ–±–æ—á—É –ø–∞–ø–∫—É
```bash
mkdir D:\ALPR_Training
cd D:\ALPR_Training
```

### 2.2 –ó–±—ñ—Ä —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç—É

#### –û–ø—Ü—ñ—è 1: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

**CCPD (Chinese City Parking Dataset)** - –Ω–∞–π–±—ñ–ª—å—à–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç
- –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏: https://github.com/detectRecog/CCPD
- –ú—ñ—Å—Ç–∏—Ç—å: 300,000+ –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ –∞–Ω–æ—Ç–∞—Ü—ñ—è–º–∏
- –§–æ—Ä–º–∞—Ç: bbox –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ + —Ç–µ–∫—Å—Ç –Ω–æ–º–µ—Ä–∞ —É –Ω–∞–∑–≤—ñ —Ñ–∞–π–ª—É

**–Ü–Ω—à—ñ –∫–æ—Ä–∏—Å–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏:**
- OpenALPR Benchmark: https://github.com/openalpr/benchmarks
- Stanford Cars Dataset: http://ai.stanford.edu/~jkrause/cars/car_dataset.html
- Kaggle Car License Plate Detection: https://www.kaggle.com/datasets

#### –û–ø—Ü—ñ—è 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç—É

**–ö—Ä–æ–∫ 1: –ó–±—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å**
1. –ó—Ä–æ–±—ñ—Ç—å 500-1000 —Ñ–æ—Ç–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏—Ö —Ä–∞–∫—É—Ä—Å—ñ–≤
2. –†—ñ–∑–Ω—ñ —É–º–æ–≤–∏: –¥–µ–Ω—å/–Ω—ñ—á, —Ä—ñ–∑–Ω–∞ –æ—Å–≤—ñ—Ç–ª–µ–Ω—ñ—Å—Ç—å, –≤—ñ–¥—Å—Ç–∞–Ω—å
3. –§–æ—Ä–º–∞—Ç: JPG, —Ä–æ–∑–º—ñ—Ä: 640x480 –∞–±–æ –±—ñ–ª—å—à–µ

**–ö—Ä–æ–∫ 2: –†–æ–∑–º—ñ—Ç–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å**

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ **LabelImg** –¥–ª—è —Ä–æ–∑–º—ñ—Ç–∫–∏:
```bash
labelImg
```

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–∑–Ω–∞—á—Ç–µ:
- **–ï—Ç–∞–ø 1 (Detection):** –ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –Ω–∞–≤–∫–æ–ª–æ –≤—Å—å–æ–≥–æ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É
- **–ï—Ç–∞–ø 2 (Polygon):** 4 –∫—É—Ç–æ–≤—ñ —Ç–æ—á–∫–∏ –Ω–æ–º–µ—Ä–∞ (—Ç–æ—á–Ω—ñ—à–µ)
- **–ï—Ç–∞–ø 3 (OCR):** –¢–µ–∫—Å—Ç –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É

–ó–±–µ—Ä–µ–∂—ñ—Ç—å –∞–Ω–æ—Ç–∞—Ü—ñ—ó —É —Ñ–æ—Ä–º–∞—Ç—ñ **YOLO** –∞–±–æ **PASCAL VOC**.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç—É:
```
D:\ALPR_Training\dataset\
‚îú‚îÄ‚îÄ images\
‚îÇ   ‚îú‚îÄ‚îÄ train\        # 80% –¥–∞–Ω–∏—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ car1.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ car2.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ val\          # 20% –¥–∞–Ω–∏—Ö
‚îÇ       ‚îú‚îÄ‚îÄ car501.jpg
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ labels\
‚îÇ   ‚îú‚îÄ‚îÄ train\
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ car1.txt  # Bbox –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ val\
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ plates\           # –í–∏—Ä—ñ–∑–∑–∞–Ω—ñ –Ω–æ–º–µ—Ä–∏ –¥–ª—è OCR
    ‚îú‚îÄ‚îÄ ABC1234.jpg
    ‚îî‚îÄ‚îÄ ...
```

### 2.3 –ú–æ–¥–µ–ª—å 1: –í–∏—è–≤–ª–µ–Ω–Ω—è –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É (Detection)

#### –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `train_detection.py`:

```python
"""
–ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤
–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞: MobileNetV2 (–æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –¥–ª—è ESP32)
"""

import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
import cv2
import os

# ============================================
# –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–Ø
# ============================================
IMG_SIZE = 320  # ESP32 –æ–±–º–µ–∂–µ–Ω–Ω—è –ø–∞–º'—è—Ç—ñ
BATCH_SIZE = 16
EPOCHS = 50
LEARNING_RATE = 0.001

DATASET_PATH = "D:/ALPR_Training/dataset"
MODEL_SAVE_PATH = "D:/ALPR_Training/models/detection_model.tflite"

# ============================================
# –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –î–ê–ù–ò–•
# ============================================
def load_detection_dataset():
    """
    –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ bbox –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
    –§–æ—Ä–º–∞—Ç bbox: [x1, y1, x2, y2, confidence]
    """
    images = []
    bboxes = []
    
    # –ß–∏—Ç–∞–Ω–Ω—è —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å
    train_path = os.path.join(DATASET_PATH, "images/train")
    labels_path = os.path.join(DATASET_PATH, "labels/train")
    
    for img_name in os.listdir(train_path):
        # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
        img_path = os.path.join(train_path, img_name)
        img = cv2.imread(img_path)
        img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)  # –ß–æ—Ä–Ω–æ-–±—ñ–ª–µ
        img = cv2.resize(img, (IMG_SIZE, IMG_SIZE))
        img = img / 255.0  # –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è
        
        # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ bbox –∑ .txt —Ñ–∞–π–ª—É (YOLO —Ñ–æ—Ä–º–∞—Ç)
        label_name = img_name.replace('.jpg', '.txt')
        label_path = os.path.join(labels_path, label_name)
        
        with open(label_path, 'r') as f:
            # YOLO —Ñ–æ—Ä–º–∞—Ç: class x_center y_center width height
            line = f.readline().strip().split()
            x_center, y_center, width, height = map(float, line[1:5])
            
            # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤ [x1, y1, x2, y2]
            x1 = (x_center - width/2) * IMG_SIZE
            y1 = (y_center - height/2) * IMG_SIZE
            x2 = (x_center + width/2) * IMG_SIZE
            y2 = (y_center + height/2) * IMG_SIZE
            
            bboxes.append([x1, y1, x2, y2, 1.0])  # confidence=1.0
        
        images.append(img)
    
    return np.array(images)[..., np.newaxis], np.array(bboxes)

# ============================================
# –ü–û–ë–£–î–û–í–ê –ú–û–î–ï–õ–Ü
# ============================================
def create_detection_model():
    """
    MobileNetV2 –∑ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ—é –≥–æ–ª–æ–≤–æ—é –¥–ª—è bbox
    """
    # –ë–∞–∑–æ–≤–∞ –º–æ–¥–µ–ª—å (–ª–µ–≥–∫–∞ –≤–µ—Ä—Å—ñ—è)
    base_model = keras.applications.MobileNetV2(
        input_shape=(IMG_SIZE, IMG_SIZE, 1),
        include_top=False,
        weights=None,  # –ë–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è (grayscale)
        alpha=0.35     # –ù–∞–π–º–µ–Ω—à–∞ –≤–µ—Ä—Å—ñ—è –¥–ª—è ESP32
    )
    
    # –î–æ–¥–∞—î–º–æ –≥–æ–ª–æ–≤—É –¥–ª—è –¥–µ—Ç–µ–∫—Ü—ñ—ó
    model = keras.Sequential([
        base_model,
        layers.GlobalAveragePooling2D(),
        layers.Dense(128, activation='relu'),
        layers.Dropout(0.3),
        layers.Dense(64, activation='relu'),
        layers.Dense(5)  # [x1, y1, x2, y2, confidence]
    ])
    
    return model

# ============================================
# –ù–ê–í–ß–ê–ù–ù–Ø
# ============================================
def train_detection():
    print("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É...")
    X_train, y_train = load_detection_dataset()
    print(f"–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ {len(X_train)} –∑–æ–±—Ä–∞–∂–µ–Ω—å")
    
    print("–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ...")
    model = create_detection_model()
    
    # –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
    model.compile(
        optimizer=keras.optimizers.Adam(LEARNING_RATE),
        loss='mse',  # Mean Squared Error –¥–ª—è —Ä–µ–≥—Ä–µ—Å—ñ—ó bbox
        metrics=['mae']
    )
    
    print("–ü–æ—á–∞—Ç–æ–∫ –Ω–∞–≤—á–∞–Ω–Ω—è...")
    history = model.fit(
        X_train, y_train,
        batch_size=BATCH_SIZE,
        epochs=EPOCHS,
        validation_split=0.2,
        callbacks=[
            keras.callbacks.EarlyStopping(patience=10, restore_best_weights=True),
            keras.callbacks.ReduceLROnPlateau(factor=0.5, patience=5)
        ]
    )
    
    print("–ù–∞–≤—á–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    return model, history

# ============================================
# –ö–û–ù–í–ï–†–¢–ê–¶–Ü–Ø –í TFLITE
# ============================================
def convert_to_tflite(model, save_path):
    """
    –ö–æ–Ω–≤–µ—Ä—Ç—É—î –º–æ–¥–µ–ª—å —É TensorFlow Lite –∑ INT8 –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü—ñ—î—é
    """
    print("–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —É TFLite...")
    
    # –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä
    converter = tf.lite.TFLiteConverter.from_keras_model(model)
    
    # –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –¥–ª—è ESP32
    converter.optimizations = [tf.lite.Optimize.DEFAULT]
    converter.target_spec.supported_types = [tf.int8]
    
    # –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏
    tflite_model = converter.convert()
    
    # –ó–±–µ—Ä–µ–≥—Ç–∏
    with open(save_path, 'wb') as f:
        f.write(tflite_model)
    
    print(f"–ú–æ–¥–µ–ª—å –∑–±–µ—Ä–µ–∂–µ–Ω–æ: {save_path}")
    print(f"–†–æ–∑–º—ñ—Ä: {len(tflite_model) / 1024:.2f} KB")

# ============================================
# –ì–û–õ–û–í–ù–ê –§–£–ù–ö–¶–Ü–Ø
# ============================================
if __name__ == "__main__":
    # –ù–∞–≤—á–∏—Ç–∏ –º–æ–¥–µ–ª—å
    model, history = train_detection()
    
    # –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ —É TFLite
    convert_to_tflite(model, MODEL_SAVE_PATH)
    
    print("\n‚úÖ –ú–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü—ñ—ó –≥–æ—Ç–æ–≤–∞!")
```

#### –ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è:
```bash
python train_detection.py
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è:** 1-3 –≥–æ–¥–∏–Ω–∏ (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ –ü–ö)

### 2.4 –ú–æ–¥–µ–ª—å 2: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—É—Ç—ñ–≤ (Polygon)

#### –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `train_polygon.py`:

```python
"""
–ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è 4 –∫—É—Ç–æ–≤–∏—Ö —Ç–æ—á–æ–∫ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É
"""

import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
import cv2

IMG_SIZE = 64  # –ú–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ
EPOCHS = 30

def create_polygon_model():
    """
    CNN –¥–ª—è —Ä–µ–≥—Ä–µ—Å—ñ—ó 8 –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (4 —Ç–æ—á–∫–∏ x 2)
    """
    model = keras.Sequential([
        layers.Input(shape=(IMG_SIZE, IMG_SIZE, 1)),
        
        layers.Conv2D(32, 3, activation='relu', padding='same'),
        layers.MaxPooling2D(2),
        
        layers.Conv2D(64, 3, activation='relu', padding='same'),
        layers.MaxPooling2D(2),
        
        layers.Conv2D(128, 3, activation='relu', padding='same'),
        layers.GlobalAveragePooling2D(),
        
        layers.Dense(64, activation='relu'),
        layers.Dropout(0.3),
        layers.Dense(9)  # 8 –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç + 1 confidence
    ])
    
    return model

def wing_loss(y_true, y_pred, omega=10, epsilon=2):
    """
    Wing Loss - –∫—Ä–∞—â–µ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö —Ç–æ—á–æ–∫
    """
    delta = tf.abs(y_true - y_pred)
    c = omega * (1 - tf.math.log(1 + omega / epsilon))
    loss = tf.where(
        delta < omega,
        omega * tf.math.log(1 + delta / epsilon),
        delta - c
    )
    return tf.reduce_mean(loss)

def train_polygon():
    # TODO: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç –∑ 4 –∫—É—Ç–æ–≤–∏–º–∏ —Ç–æ—á–∫–∞–º–∏
    # –§–æ—Ä–º–∞—Ç: [x1, y1, x2, y2, x3, y3, x4, y4, confidence]
    
    model = create_polygon_model()
    model.compile(optimizer='adam', loss=wing_loss)
    
    # model.fit(X_train, y_train, epochs=EPOCHS)
    
    # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è
    converter = tf.lite.TFLiteConverter.from_keras_model(model)
    converter.optimizations = [tf.lite.Optimize.DEFAULT]
    tflite_model = converter.convert()
    
    with open('D:/ALPR_Training/models/polygon_model.tflite', 'wb') as f:
        f.write(tflite_model)

if __name__ == "__main__":
    train_polygon()
    print("‚úÖ –ú–æ–¥–µ–ª—å polygon –≥–æ—Ç–æ–≤–∞!")
```

### 2.5 –ú–æ–¥–µ–ª—å 3: –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ (OCR)

#### –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `train_ocr.py`:

```python
"""
–ù–∞–≤—á–∞–Ω–Ω—è OCR –º–æ–¥–µ–ª—ñ –∑ CTC Loss
–ß–∏—Ç–∞—î —Ç–µ–∫—Å—Ç –∑ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫—É
"""

import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np

# –°–∏–º–≤–æ–ª–∏ —è–∫—ñ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î–º–æ
CHARACTERS = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
CHAR_TO_NUM = {char: idx for idx, char in enumerate(CHARACTERS)}
NUM_TO_CHAR = {idx: char for idx, char in enumerate(CHARACTERS)}

IMG_WIDTH = 128
IMG_HEIGHT = 64
MAX_TEXT_LEN = 10  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –Ω–æ–º–µ—Ä–∞

def create_ocr_model():
    """
    CNN + RNN –∑ CTC Loss –¥–ª—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É
    """
    input_img = layers.Input(shape=(IMG_HEIGHT, IMG_WIDTH, 1), name='image')
    
    # CNN —á–∞—Å—Ç–∏–Ω–∞ (–≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –æ–∑–Ω–∞–∫)
    x = layers.Conv2D(32, (3, 3), activation='relu', padding='same')(input_img)
    x = layers.MaxPooling2D((2, 2))(x)
    
    x = layers.Conv2D(64, (3, 3), activation='relu', padding='same')(x)
    x = layers.MaxPooling2D((2, 2))(x)
    
    x = layers.Conv2D(128, (3, 3), activation='relu', padding='same')(x)
    x = layers.MaxPooling2D((2, 2))(x)
    
    # Reshape –¥–ª—è RNN
    new_shape = ((IMG_WIDTH // 8), (IMG_HEIGHT // 8) * 128)
    x = layers.Reshape(target_shape=new_shape)(x)
    
    # RNN —á–∞—Å—Ç–∏–Ω–∞ (–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Å–∏–º–≤–æ–ª—ñ–≤)
    # –£–í–ê–ì–ê: RNN –º–æ–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç–∏—Å—å –≤ ESP32, —Ç–æ–º—É –º–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏
    x = layers.Bidirectional(layers.LSTM(64, return_sequences=True))(x)
    
    # –í–∏—Ö—ñ–¥: –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ —Å–∏–º–≤–æ–ª—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
    x = layers.Dense(64, activation='relu')(x)
    output = layers.Dense(len(CHARACTERS) + 1, activation='softmax')(x)  # +1 –¥–ª—è blank
    
    model = keras.Model(inputs=input_img, outputs=output, name='ocr_model')
    return model

def ctc_loss_function(y_true, y_pred):
    """
    CTC Loss –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π
    """
    batch_len = tf.cast(tf.shape(y_true)[0], dtype="int64")
    input_length = tf.cast(tf.shape(y_pred)[1], dtype="int64")
    label_length = tf.cast(tf.shape(y_true)[1], dtype="int64")
    
    input_length = input_length * tf.ones(shape=(batch_len, 1), dtype="int64")
    label_length = label_length * tf.ones(shape=(batch_len, 1), dtype="int64")
    
    loss = keras.backend.ctc_batch_cost(y_true, y_pred, input_length, label_length)
    return loss

def generate_synthetic_plates(num_samples=10000):
    """
    –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤
    –ö–æ—Ä–∏—Å–Ω–æ –∫–æ–ª–∏ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –º–∞–ª–æ
    """
    from PIL import Image, ImageDraw, ImageFont
    import random
    
    images = []
    labels = []
    
    for i in range(num_samples):
        # –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –Ω–æ–º–µ—Ä
        plate_text = ''.join(random.choices(CHARACTERS, k=7))
        
        # –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
        img = Image.new('L', (IMG_WIDTH, IMG_HEIGHT), color=255)
        draw = ImageDraw.Draw(img)
        
        # –î–æ–¥–∞—Ç–∏ —Ç–µ–∫—Å—Ç (–ø–æ—Ç—Ä—ñ–±–µ–Ω TTF —à—Ä–∏—Ñ—Ç)
        try:
            font = ImageFont.truetype("arial.ttf", 36)
            draw.text((10, 10), plate_text, font=font, fill=0)
        except:
            # –Ø–∫—â–æ —à—Ä–∏—Ñ—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π
            draw.text((10, 20), plate_text, fill=0)
        
        # –î–æ–¥–∞—Ç–∏ —à—É–º —Ç–∞ –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—ó
        img_array = np.array(img)
        img_array = img_array + np.random.normal(0, 10, img_array.shape)
        img_array = np.clip(img_array, 0, 255).astype(np.uint8)
        
        images.append(img_array / 255.0)
        
        # –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç —É —á–∏—Å–ª–∞
        label = [CHAR_TO_NUM[c] for c in plate_text]
        labels.append(label)
    
    return np.array(images)[..., np.newaxis], labels

def train_ocr():
    print("–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤...")
    X_train, y_train = generate_synthetic_plates(10000)
    
    print("–°—Ç–≤–æ—Ä–µ–Ω–Ω—è OCR –º–æ–¥–µ–ª—ñ...")
    model = create_ocr_model()
    model.compile(optimizer='adam', loss=ctc_loss_function)
    
    print("–ù–∞–≤—á–∞–Ω–Ω—è OCR –º–æ–¥–µ–ª—ñ...")
    # –ü–æ—Ç—Ä—ñ–±–Ω–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è CTC
    # model.fit(X_train, y_train, epochs=50, batch_size=32)
    
    # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è
    converter = tf.lite.TFLiteConverter.from_keras_model(model)
    converter.optimizations = [tf.lite.Optimize.DEFAULT]
    tflite_model = converter.convert()
    
    with open('D:/ALPR_Training/models/ocr_model.tflite', 'wb') as f:
        f.write(tflite_model)
    
    print(f"–†–æ–∑–º—ñ—Ä –º–æ–¥–µ–ª—ñ: {len(tflite_model) / 1024:.2f} KB")

if __name__ == "__main__":
    train_ocr()
    print("‚úÖ OCR –º–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞!")
```

### 2.6 –í–∞–∂–ª–∏–≤—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏ –ø—Ä–æ –Ω–∞–≤—á–∞–Ω–Ω—è

**–†–æ–∑–º—ñ—Ä–∏ –º–æ–¥–µ–ª–µ–π –¥–ª—è ESP32:**
- Detection: < 200 KB
- Polygon: < 50 KB
- OCR: < 300 KB
- **–í—Å—å–æ–≥–æ: < 550 KB** (ESP32 –º–∞—î 4 MB Flash)

**–Ø–∫—â–æ –º–æ–¥–µ–ª—å –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∞:**
1. –ó–º–µ–Ω—à—ñ—Ç—å `alpha` –ø–∞—Ä–∞–º–µ—Ç—Ä MobileNet (0.35 ‚Üí 0.25)
2. –ó–º–µ–Ω—à—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ —É Conv2D —à–∞—Ä–∞—Ö
3. –í–∏–¥–∞–ª—ñ—Ç—å RNN —à–∞—Ä–∏ –∑ OCR –º–æ–¥–µ–ª—ñ
4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –±—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω—É –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü—ñ—é

**–ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:**
- TensorFlow Lite Guide: https://www.tensorflow.org/lite/guide
- Model Optimization: https://www.tensorflow.org/model_optimization
- CCPD Dataset Paper: https://arxiv.org/abs/1902.09837

---

## –ß–∞—Å—Ç–∏–Ω–∞ 3: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –º–æ–¥–µ–ª–µ–π —É ESP32

### 3.1 –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è TFLite –º–æ–¥–µ–ª–µ–π —É C-–º–∞—Å–∏–≤–∏

–ü—ñ—Å–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —É –≤–∞—Å —î 3 —Ñ–∞–π–ª–∏ `.tflite`. –á—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ —É C-–∫–æ–¥.

#### –ú–µ—Ç–æ–¥ 1: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è xxd (Linux/WSL)

```bash
cd D:\ALPR_Training\models

# –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –∫–æ–∂–Ω—É –º–æ–¥–µ–ª—å
xxd -i detection_model.tflite > detection_model.h
xxd -i polygon_model.tflite > polygon_model.h
xxd -i ocr_model.tflite > ocr_model.h
```

#### –ú–µ—Ç–æ–¥ 2: –û–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä (–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π)

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ: https://notisrac.github.io/FileToCArray/
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ `detection_model.tflite`
3. –í–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ä–º–∞—Ç: **C Array**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Convert**
5. –°–∫–æ–ø—ñ—é–π—Ç–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ–¥

#### –ú–µ—Ç–æ–¥ 3: Python —Å–∫—Ä–∏–ø—Ç

–°—Ç–≤–æ—Ä—ñ—Ç—å `convert_to_c.py`:

```python
"""
–ö–æ–Ω–≤–µ—Ä—Ç—É—î .tflite —Ñ–∞–π–ª —É C-–º–∞—Å–∏–≤
"""

def convert_tflite_to_c(tflite_path, output_path, array_name):
    with open(tflite_path, 'rb') as f:
        tflite_data = f.read()
    
    # –°—Ç–≤–æ—Ä–∏—Ç–∏ C-–∫–æ–¥
    c_code = f"// Auto-generated from {tflite_path}\n"
    c_code += f"// Size: {len(tflite_data)} bytes\n\n"
    c_code += f"const unsigned char {array_name}[] = {{\n"
    
    # –î–æ–¥–∞—Ç–∏ –±–∞–π—Ç–∏
    for i in range(0, len(tflite_data), 12):
        chunk = tflite_data[i:i+12]
        hex_values = ', '.join(f'0x{b:02x}' for b in chunk)
        c_code += f"    {hex_values},\n"
    
    c_code += "};\n\n"
    c_code += f"const unsigned int {array_name}_len = sizeof({array_name});\n"
    
    # –ó–±–µ—Ä–µ–≥—Ç–∏
    with open(output_path, 'w') as f:
        f.write(c_code)
    
    print(f"‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–æ: {output_path}")
    print(f"   –†–æ–∑–º—ñ—Ä: {len(tflite_data) / 1024:.2f} KB")

# –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å—ñ 3 –º–æ–¥–µ–ª—ñ
convert_tflite_to_c(
    'D:/ALPR_Training/models/detection_model.tflite',
    'D:/ALPR_Training/models/detection_model.h',
    'detection_model_data'
)

convert_tflite_to_c(
    'D:/ALPR_Training/models/polygon_model.tflite',
    'D:/ALPR_Training/models/polygon_model.h',
    'polygon_model_data'
)

convert_tflite_to_c(
    'D:/ALPR_Training/models/ocr_model.tflite',
    'D:/ALPR_Training/models/ocr_model.h',
    'ocr_model_data'
)
```

–ó–∞–ø—É—Å—Ç—ñ—Ç—å:
```bash
python convert_to_c.py
```

### 3.2 –ó–∞–º—ñ–Ω–∞ –∑–∞–≥–ª—É—à–æ–∫ –º–æ–¥–µ–ª–µ–π

–¢–µ–ø–µ—Ä —É –≤–∞—Å —î 3 —Ñ–∞–π–ª–∏ `.h` –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –∑–∞–≥–ª—É—à–∫–∏ –≤ –ø—Ä–æ—î–∫—Ç—ñ.

#### –ö—Ä–æ–∫ 1: –í—ñ–¥–∫—Ä–∏–π—Ç–µ –ø—Ä–æ—î–∫—Ç ESP32

1. VS Code ‚Üí Open Folder ‚Üí `Esp32Cam_LPR`

#### –ö—Ä–æ–∫ 2: –ó–∞–º—ñ–Ω—ñ—Ç—å detection_model.h

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π `D:/ALPR_Training/models/detection_model.h`
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–µ—Å—å –≤–º—ñ—Å—Ç
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ `Esp32Cam_LPR/src/detection_model.h`
4. **–ó–ê–ú–Ü–ù–Ü–¢–¨** —Ç—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∏–Ω—É –∑ –º–∞—Å–∏–≤–æ–º:

```cpp
#ifndef DETECTION_MODEL_H
#define DETECTION_MODEL_H

// ============================================
// –í–°–¢–ê–í–¢–ï –°–Æ–î–ò –í–ê–® –ó–ì–ï–ù–ï–†–û–í–ê–ù–ò–ô –ö–û–î
// ============================================
const unsigned char detection_model_data[] = {
    0x1c, 0x00, 0x00, 0x00, 0x54, 0x46, ...  // –í–∞—à—ñ –¥–∞–Ω—ñ
};

const unsigned int detection_model_len = sizeof(detection_model_data);

#endif // DETECTION_MODEL_H
```

#### –ö—Ä–æ–∫ 3: –ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –¥–ª—è polygon_model.h

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `Esp32Cam_LPR/src/polygon_model.h` —Ç–∞ –∑–∞–º—ñ–Ω—ñ—Ç—å –º–∞—Å–∏–≤ –¥–∞–Ω–∏—Ö.

#### –ö—Ä–æ–∫ 4: –ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –¥–ª—è ocr_model.h

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `Esp32Cam_LPR/src/ocr_model.h` —Ç–∞ –∑–∞–º—ñ–Ω—ñ—Ç—å –º–∞—Å–∏–≤ –¥–∞–Ω–∏—Ö.

### 3.3 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª–µ–π

–Ø–∫—â–æ –≤–∏ –∑–º—ñ–Ω—é–≤–∞–ª–∏ —Ä–æ–∑–º—ñ—Ä–∏ –≤—Ö–æ–¥—É –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è, –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –≤ `main.cpp`:

#### –í—ñ–¥–∫—Ä–∏–π—Ç–µ `src/main.cpp` —Ç–∞ –∑–Ω–∞–π–¥—ñ—Ç—å:

```cpp
// Stage 1: Detection model config
const int DETECTION_INPUT_WIDTH = 320;
const int DETECTION_INPUT_HEIGHT = 320;

// Stage 2: Polygon model config
const int POLYGON_INPUT_WIDTH = 64;
const int POLYGON_INPUT_HEIGHT = 64;

// Stage 3: OCR model config
const int OCR_INPUT_WIDTH = 128;
const int OCR_INPUT_HEIGHT = 64;
const int MAX_PLATE_CHARS = 10;
```

**–ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–∞—à–∏—Ö –º–æ–¥–µ–ª–µ–π!**

### 3.4 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Tensor Arena (–ø–∞–º'—è—Ç—å)

ESP32 –º–∞—î –æ–±–º–µ–∂–µ–Ω—É RAM. –ú–æ–∂–ª–∏–≤–æ —Ç—Ä–µ–±–∞ –±—É–¥–µ –ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ —Ä–æ–∑–º—ñ—Ä –±—É—Ñ–µ—Ä–∞.

#### –£ `main.cpp` –∑–Ω–∞–π–¥—ñ—Ç—å:

```cpp
constexpr int kTensorArenaSize = 80 * 1024;  // 80 KB
uint8_t tensor_arena[kTensorArenaSize] __attribute__((aligned(16)));
```

**–°–∏–º–ø—Ç–æ–º–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –ø–∞–º'—è—Ç—ñ:**
- ESP32 –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è
- –ü–æ–º–∏–ª–∫–∞ "Failed to allocate memory"
- –ó–∞–≤–∏—Å–∞–Ω–Ω—è –ø—ñ–¥ —á–∞—Å —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É

**–†—ñ—à–µ–Ω–Ω—è:**
1. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–±—ñ–ª—å—à–∏—Ç–∏ –¥–æ `100 * 1024` (100 KB)
2. –Ø–∫—â–æ –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î, –∑–º–µ–Ω—à—ñ—Ç—å –º–æ–¥–µ–ª—ñ
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π (–ø–æ –æ–¥–Ω—ñ–π)

### 3.5 –§—ñ–Ω–∞–ª—å–Ω–∞ –∑–±—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

#### –ö—Ä–æ–∫ 1: –ó–±—É–¥—É–π—Ç–µ –ø—Ä–æ—î–∫—Ç

```bash
cd D:\Sandbox\ESP ML\Esp32Cam_LPR
pio run
```

**–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –Ω–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫!**

#### –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–∞ ESP32-CAM

1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å ESP32-CAM –¥–æ USB-TTL
2. **–ó–∞–º–∫–Ω—ñ—Ç—å IO0 –Ω–∞ GND**
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ:
   ```bash
   pio run --target upload
   ```
4. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å "SUCCESS"
5. **–í—ñ–¥–∫–ª—é—á—ñ—Ç—å IO0 –≤—ñ–¥ GND**
6. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å RESET

#### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–±–æ—Ç—É

–í—ñ–¥–∫—Ä–∏–π—Ç–µ Serial Monitor:
```bash
pio device monitor
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–∏–≤—ñ–¥ –ø—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ –Ω–æ–º–µ—Ä–∞:**
```
============================================================
=== AUTOMATIC LICENSE PLATE RECOGNITION ===
============================================================
Image captured: 320x240 (76800 bytes)

Stage 1 (Detection): ‚úì Plate detected
  Bounding box: [45, 67, 275, 123]
  Confidence: 94.3%

Stage 2 (Polygon): ‚úì Corners detected
  Points: [(46,68), (274,69), (273,122), (47,121)]

Stage 3 (OCR): ‚úì Text recognized
  üìã LICENSE PLATE: ABC1234

Timing Breakdown:
  Stage 1 (Detection):   287 ms
  Stage 2 (Polygon):     95 ms
  Stage 3 (OCR):         412 ms
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  Total:                 794 ms

  Confidence: 94.3%
  Free heap: 187456 bytes
============================================================
```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

### 4.1 –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π

#### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö

1. –ù–∞–ø—Ä–∞–≤—Ç–µ –∫–∞–º–µ—Ä—É ESP32-CAM –Ω–∞ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å –∑ –Ω–æ–º–µ—Ä–æ–º
2. –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ Serial Monitor
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–Ω–æ —Ç–µ–∫—Å—Ç

#### –¢–∏–ø–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†—ñ—à–µ–Ω–Ω—è |
|----------|---------|---------|
| –ù–æ–º–µ—Ä –Ω–µ –≤–∏—è–≤–ª—è—î—Ç—å—Å—è | –ú–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü—ñ—ó —Å–ª–∞–±–∫–∞ | –ë—ñ–ª—å—à–µ –¥–∞–Ω–∏—Ö, –±—ñ–ª—å—à–µ –µ–ø–æ—Ö |
| –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç | OCR –º–æ–¥–µ–ª—å –Ω–µ–¥–æ–Ω–∞–≤—á–µ–Ω–∞ | –°–∏–Ω—Ç–µ—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ, –∞—É–≥–º–µ–Ω—Ç–∞—Ü—ñ—è |
| –ü–æ–≤—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ (>2 —Å–µ–∫) | –ú–æ–¥–µ–ª—ñ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫—ñ | –ó–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä, –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü—ñ—è |
| ESP32 –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è | –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ RAM | –ó–º–µ–Ω—à–∏—Ç–∏ tensor_arena |
| –ó–∞–≤–∂–¥–∏ 0% confidence | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è | –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ preprocessing |

### 4.2 –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —à–≤–∏–¥–∫–æ–¥—ñ—ó

**–ü–æ—Ç–æ—á–Ω—ñ —Ü—ñ–ª—å–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏:**
- Detection: < 300 ms
- Polygon: < 100 ms
- OCR: < 500 ms
- **–í—Å—å–æ–≥–æ: < 1000 ms (1 —Å–µ–∫—É–Ω–¥–∞)**

**–Ø–∫ –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏:**
1. –ó–º–µ–Ω—à–∏—Ç–∏ –≤—Ö—ñ–¥–Ω–∏–π —Ä–æ–∑–º—ñ—Ä (320 ‚Üí 224)
2. –í–∏–¥–∞–ª–∏—Ç–∏ RNN –∑ OCR –º–æ–¥–µ–ª—ñ
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ INT8 –∑–∞–º—ñ—Å—Ç—å FLOAT32
4. –û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ preprocessing (–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è)

### 4.3 –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ

**–ó–±—ñ—Ä –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤:**
1. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–µ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è
2. –î–æ–¥–∞–π—Ç–µ —ó—Ö –¥–æ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç—É
3. –ü–µ—Ä–µ–Ω–∞–≤—á—ñ—Ç—å –º–æ–¥–µ–ª—ñ

**–ê—É–≥–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö:**
```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator

datagen = ImageDataGenerator(
    rotation_range=10,
    width_shift_range=0.1,
    height_shift_range=0.1,
    brightness_range=[0.7, 1.3],
    zoom_range=0.2
)
```

---

## –î–æ–¥–∞—Ç–∫–∏

### –î–æ–¥–∞—Ç–æ–∫ –ê: –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:**
- ESP32-CAM Pinout: https://randomnerdtutorials.com/esp32-cam-ai-thinker-pinout/
- PlatformIO Docs: https://docs.platformio.org/
- TensorFlow Lite: https://www.tensorflow.org/lite
- Arduino ESP32: https://docs.espressif.com/projects/arduino-esp32/

**–î–∞—Ç–∞—Å–µ—Ç–∏:**
- CCPD: https://github.com/detectRecog/CCPD
- OpenALPR: https://github.com/openalpr/benchmarks
- Kaggle Plates: https://www.kaggle.com/datasets/andrewmvd/car-plate-detection

**–ù–∞–≤—á–∞–ª—å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏:**
- TensorFlow Tutorials: https://www.tensorflow.org/tutorials
- Keras Documentation: https://keras.io/guides/
- ESP32 ML: https://github.com/espressif/esp-dl

**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:**
- LabelImg: https://github.com/heartexlabs/labelImg
- Netron (–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–¥–µ–ª–µ–π): https://netron.app/
- Edge Impulse: https://www.edgeimpulse.com/

### –î–æ–¥–∞—Ç–æ–∫ –ë: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
Esp32Cam_LPR/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp                 # –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ detection_model.h        # –ú–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ polygon_model.h          # –ú–æ–¥–µ–ª—å –∫—É—Ç—ñ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ocr_model.h             # OCR –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ platformio.ini              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è PlatformIO
‚îú‚îÄ‚îÄ README.md                   # –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–ø–∏—Å
‚îú‚îÄ‚îÄ –Ü–ù–°–¢–†–£–ö–¶–Ü–Ø_–î–õ–Ø_–°–¢–£–î–ï–ù–¢–ê.md  # –¶–µ–π —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ docs/                       # –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
```

### –î–æ–¥–∞—Ç–æ–∫ –í: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è ESP32-CAM

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–Ω—è |
|----------|----------|
| –ü—Ä–æ—Ü–µ—Å–æ—Ä | ESP32-S (Dual-core 240 MHz) |
| RAM | 520 KB SRAM |
| Flash | 4 MB |
| PSRAM | 4 MB (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) |
| –ö–∞–º–µ—Ä–∞ | OV2640 (2 MP) |
| WiFi | 802.11 b/g/n |
| Bluetooth | BT 4.2 / BLE |
| –°–ø–æ–∂–∏–≤–∞–Ω–Ω—è | ~160 mA (–∞–∫—Ç–∏–≤–Ω–∞ –∫–∞–º–µ—Ä–∞) |

### –î–æ–¥–∞—Ç–æ–∫ –ì: –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–¥–∞—á–µ—é –ø—Ä–æ—î–∫—Ç—É

- [ ] PlatformIO –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ç–∞ –ø—Ä–∞—Ü—é—î
- [ ] –ü—Ä–æ—î–∫—Ç –∑–±–∏—Ä–∞—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- [ ] ESP32-CAM —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ—à–∏–≤–∞—î—Ç—å—Å—è
- [ ] –ö–∞–º–µ—Ä–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è (Serial Monitor)
- [ ] –ó—ñ–±—Ä–∞–Ω–æ –º—ñ–Ω—ñ–º—É–º 500 –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–∞—Ç–∞—Å–µ—Ç—É
- [ ] –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—á–µ–Ω—ñ (bbox + —Ç–µ–∫—Å—Ç)
- [ ] –ù–∞–≤—á–µ–Ω–æ –º–æ–¥–µ–ª—å Detection (—Ç–æ—á–Ω—ñ—Å—Ç—å >80%)
- [ ] –ù–∞–≤—á–µ–Ω–æ –º–æ–¥–µ–ª—å Polygon
- [ ] –ù–∞–≤—á–µ–Ω–æ –º–æ–¥–µ–ª—å OCR (—Ç–æ—á–Ω—ñ—Å—Ç—å >85%)
- [ ] –ú–æ–¥–µ–ª—ñ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–æ —É .tflite
- [ ] .tflite –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–æ —É .h —Ñ–∞–π–ª–∏
- [ ] –ú–æ–¥–µ–ª—ñ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ —É ESP32 –∫–æ–¥
- [ ] –ü—Ä–æ—î–∫—Ç –∑–±–∏—Ä–∞—î—Ç—å—Å—è –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏
- [ ] –°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –Ω–æ–º–µ—Ä–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- [ ] –ß–∞—Å —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É < 2 —Å–µ–∫—É–Ω–¥–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–æ –≤—Å—ñ –∫—Ä–æ–∫–∏ —Ä–æ–±–æ—Ç–∏
- [ ] –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

---

## –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏

**–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å (60-74 –±–∞–ª—ñ–≤):**
- –ü—Ä–æ—î–∫—Ç –∑–±–∏—Ä–∞—î—Ç—å—Å—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ø—É–±–ª—ñ—á–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏
- –ù–∞–≤—á–µ–Ω–æ —Ö–æ—á–∞ –± –æ–¥–Ω—É –º–æ–¥–µ–ª—å
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –Ω–∞ ESP32

**–°–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å (75-89 –±–∞–ª—ñ–≤):**
- –ù–∞–≤—á–∞–Ω–æ –≤—Å—ñ 3 –º–æ–¥–µ–ª—ñ
- –°—Ç–≤–æ—Ä–µ–Ω–æ –≤–ª–∞—Å–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç (100+ –∑–æ–±—Ä–∞–∂–µ–Ω—å)
- –°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –Ω–æ–º–µ—Ä–∏ –∑ —Ç–æ—á–Ω—ñ—Å—Ç—é >70%
- –ß–∞—Å —Ä–æ–±–æ—Ç–∏ < 2 —Å–µ–∫—É–Ω–¥–∏

**–í–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å (90-100 –±–∞–ª—ñ–≤):**
- –í–ª–∞—Å–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç (500+ –∑–æ–±—Ä–∞–∂–µ–Ω—å)
- –¢–æ—á–Ω—ñ—Å—Ç—å —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è >85%
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ —à–≤–∏–¥–∫–æ–¥—ñ—è (<1 —Å–µ–∫)
- –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (WiFi streaming, –ª–æ–≥—É–≤–∞–Ω–Ω—è)
- –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ü–µ—Å—É

---

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ç–∞ –ø–∏—Ç–∞–Ω–Ω—è

**–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:**

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Serial Monitor –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ –≤—Å—ñ –º–æ–¥–µ–ª—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω—ñ
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–∑–º—ñ—Ä–∏ –º–æ–¥–µ–ª–µ–π (< 550 KB —Ä–∞–∑–æ–º)
4. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–±—ñ–ª—å—à–∏—Ç–∏ tensor_arena
5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ö–µ–º—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è ESP32-CAM

**–¢–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó:**
- `error: 'xxx' was not declared` ‚Üí –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ include —Ñ–∞–π–ª–∏
- `region 'dram0_0_seg' overflowed` ‚Üí –ú–æ–¥–µ–ª—ñ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫—ñ
- `Brownout detector` ‚Üí –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –∂–∏–≤–ª–µ–Ω–Ω—è (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ 5V 2A)

**–ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:**
```bash
# –û—á–∏—Å—Ç–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç
pio run --target clean

# –ü–æ–∫–∞–∑–∞—Ç–∏ —Ä–æ–∑–º—ñ—Ä –ø—Ä–æ—à–∏–≤–∫–∏
pio run --target size

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ verbose –ª–æ–≥—É–≤–∞–Ω–Ω—è–º
pio run --target upload --verbose
```

---

**–£—Å–ø—ñ—Ö—ñ–≤ —É –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –ø—Ä–æ—î–∫—Ç—É! üöÄ**

*–Ø–∫—â–æ —É –≤–∞—Å –≤–∏–Ω–∏–∫–Ω—É—Ç—å –ø–∏—Ç–∞–Ω–Ω—è - –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ GitHub Issues –ø—Ä–æ—î–∫—Ç—É.*
